# Zed Command System Exploration
# Tests discovering how Zed handles editor commands

[scenario]
id = "zed-command-system"
name = "Understanding Zed Command Architecture"
repo = "zed"
difficulty = "hard"
description = "Explore how Zed implements its command system, from keybindings to execution"

[task]
prompt = "How does Zed handle editor commands?"
intent = "architectural_discovery"

[expected]
must_find_files = [
    "**/commands.rs",
    "**/actions.rs",
    "**/keymap/**",
]
must_find_symbols = ["Action", "actions", "dispatch", "Keymap", "KeyBinding"]
noise_patterns = ["**/tests/**", "test_*", "Mock*", "*_test.rs"]

[[steps]]
query = "How does Zed handle editor commands and actions?"
expected_results = 5
max_noise_ratio = 0.3
scope = "code"

[[steps]]
query = "Action trait definition and dispatch mechanism"
depends_on_previous = true
expected_results = 3

[[steps]]
query = "keymap keybinding keyboard shortcuts"
depends_on_previous = false
scope = "code"

[success]
min_discovery_score = 0.7
max_noise_ratio = 0.25
max_steps_to_core = 3

# LLM-as-judge comprehension testing (optional, requires --llm-judge flag)
[llm_judge]
min_comprehension_score = 0.6

[[llm_judge.comprehension_questions]]
question = "How are commands represented in Zed's architecture?"
expected_concepts = ["Action", "trait", "dispatch"]
wrong_concepts = ["Command pattern", "EventEmitter"]
weight = 1.0

[[llm_judge.comprehension_questions]]
question = "How does a keyboard shortcut trigger a command in Zed?"
expected_concepts = ["keymap", "KeyBinding", "Action"]
wrong_concepts = []
weight = 1.5

[[llm_judge.comprehension_questions]]
question = "What is the relationship between Actions and the GPUI framework?"
expected_concepts = ["gpui", "Action"]
wrong_concepts = []
weight = 1.0
